<%= form_with(model: @revision, url: {action: @revision.persisted? ? "update" : "create", inspection_id: @inspection.id}) do |form| %>

  <% if @revision.errors.any? %>
    <div style="color: red">
      <h2><%= pluralize(@revision.errors.count, "error") %> No se pudo guardar la revisión:</h2>

      <ul>
        <% @revision.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <% @rules.each do |rule| %>
    <div>
      <%= rule.code %>
      <%= rule.point %>
      <% if rule.point == "Otros defectos." %>
        <%= form.text_field :flaws, value: other_rule(@inspection.id, rule.code) %>
      <% end %>
      <%= form.check_box :codes, {}, rule.code, nil %>
      <%= form.check_box :level, {}, rule.level, nil %>
      <%= form.check_box "rule_#{rule.id}", {}, checked: false %> <!-- Checkbox for each rule -->
    </div>
  <% end %>

  <div>
    <%= form.submit "Guardar revisión" %>
  </div>
<% end %>